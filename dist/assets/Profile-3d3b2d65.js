import{N as z,j as e,r as a,aa as L,ab as O,T as o,P as V,B as i,I as g,A as H,a2 as R,b as E,C as G}from"./main-09baa353.js";import{C as N}from"./Container-b91c59b6.js";import{A}from"./Alert-75872dac.js";import{E as J}from"./Edit-0b5ca035.js";import{T as m}from"./TextField-9180dea0.js";import"./Select-f366e320.js";import"./useControlled-0aca5942.js";const K=z(e.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Cancel"),Q=z(e.jsx("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save");function ae(){const[j,h]=a.useState(!1),[f,x]=a.useState(""),[B,U]=a.useState(""),[p,v]=a.useState(""),[l,P]=a.useState(""),[w,y]=a.useState(""),[b,t]=a.useState(""),[C,d]=a.useState(""),[c,u]=a.useState(!1),{user:S,profile:s,updateProfile:W,updatePassword:_,signOut:F}=L(),k=O();a.useEffect(()=>{s&&(x(s.full_name||""),U(s.email||""))},[s]);const M=async r=>{if(r.preventDefault(),!f){t("Please enter your full name");return}u(!0),t(""),d("");try{const{error:n}=await W({full_name:f});if(n)throw n;d("Profile updated successfully"),h(!1)}catch(n){t(n.message||"Failed to update profile")}finally{u(!1)}},T=async r=>{if(r.preventDefault(),!p||!l||!w){t("Please fill in all password fields");return}if(l!==w){t("New passwords do not match");return}if(l.length<6){t("Password must be at least 6 characters long");return}u(!0),t(""),d("");try{const{user:n,error:D}=await signIn({email:S.email,password:p});if(D)throw new Error("Current password is incorrect");const{error:I}=await _(l);if(I)throw I;d("Password updated successfully"),v(""),P(""),y("")}catch(n){t(n.message||"Failed to update password")}finally{u(!1)}},q=async()=>{try{await F(),k("/")}catch(r){console.error("Error signing out:",r)}};return S?e.jsxs(N,{maxWidth:"md",sx:{mt:4,mb:4},children:[e.jsx(o,{variant:"h4",component:"h1",gutterBottom:!0,children:"My Profile"}),b&&e.jsx(A,{severity:"error",sx:{mb:3},children:b}),C&&e.jsx(A,{severity:"success",sx:{mb:3},children:C}),e.jsxs(V,{elevation:3,sx:{p:4,mb:4},children:[e.jsxs(i,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsx(o,{variant:"h6",children:"Personal Information"}),j?e.jsxs(i,{children:[e.jsx(g,{color:"primary",onClick:M,disabled:c,"aria-label":"save changes",children:e.jsx(Q,{})}),e.jsx(g,{onClick:()=>{h(!1),t(""),d(""),x(s.full_name||"")},disabled:c,"aria-label":"cancel editing",children:e.jsx(K,{})})]}):e.jsx(g,{color:"primary",onClick:()=>h(!0),"aria-label":"edit profile",children:e.jsx(J,{})})]}),e.jsxs(i,{display:"flex",alignItems:"center",mb:4,children:[e.jsx(H,{sx:{width:80,height:80,fontSize:"2rem",bgcolor:"primary.main",mr:3},children:s!=null&&s.full_name?s.full_name.charAt(0).toUpperCase():"U"}),e.jsxs(i,{children:[j?e.jsx(m,{label:"Full Name",value:f,onChange:r=>x(r.target.value),variant:"outlined",size:"small",sx:{mb:1},fullWidth:!0}):e.jsx(o,{variant:"h6",children:(s==null?void 0:s.full_name)||"No name provided"}),e.jsx(o,{variant:"body2",color:"text.secondary",children:B})]})]}),e.jsx(R,{sx:{my:3}}),e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Change Password"}),e.jsxs(i,{component:"form",onSubmit:T,noValidate:!0,children:[e.jsx(m,{margin:"normal",required:!0,fullWidth:!0,name:"currentPassword",label:"Current Password",type:"password",id:"currentPassword",autoComplete:"current-password",value:p,onChange:r=>v(r.target.value),sx:{mb:2}}),e.jsx(m,{margin:"normal",required:!0,fullWidth:!0,name:"newPassword",label:"New Password",type:"password",id:"newPassword",autoComplete:"new-password",value:l,onChange:r=>P(r.target.value),sx:{mb:2}}),e.jsx(m,{margin:"normal",required:!0,fullWidth:!0,name:"confirmPassword",label:"Confirm New Password",type:"password",id:"confirmPassword",value:w,onChange:r=>y(r.target.value),sx:{mb:3}}),e.jsx(E,{type:"submit",variant:"contained",disabled:c,startIcon:c?e.jsx(G,{size:20}):null,children:"Update Password"})]})]}),e.jsx(i,{textAlign:"center",mt:4,children:e.jsx(E,{variant:"outlined",color:"error",onClick:q,disabled:c,children:"Sign Out"})})]}):e.jsx(N,{maxWidth:"md",sx:{mt:4,textAlign:"center"},children:e.jsx(o,{variant:"h6",children:"Please sign in to view your profile"})})}export{ae as default};
//# sourceMappingURL=Profile-3d3b2d65.js.map

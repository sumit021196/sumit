{"version":3,"file":"Profile-f6940561.js","sources":["../../node_modules/@mui/icons-material/esm/Cancel.js","../../node_modules/@mui/icons-material/esm/Save.js","../../src/pages/Profile.jsx"],"sourcesContent":["\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z\"\n}), 'Cancel');","\"use client\";\n\nimport createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z\"\n}), 'Save');","import { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { \n  Container, \n  Box, \n  Typography, \n  TextField, \n  Button, \n  Paper, \n  Alert,\n  CircularProgress,\n  Divider,\n  Avatar,\n  IconButton\n} from '@mui/material';\nimport { Edit as EditIcon, Save as SaveIcon, Cancel as CancelIcon } from '@mui/icons-material';\nimport { useAuth } from '../contexts/AuthProvider';\n\nexport default function Profile() {\n  const [isEditing, setIsEditing] = useState(false);\n  const [fullName, setFullName] = useState('');\n  const [email, setEmail] = useState('');\n  const [currentPassword, setCurrentPassword] = useState('');\n  const [newPassword, setNewPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [error, setError] = useState('');\n  const [message, setMessage] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  \n  const { user, profile, loading, initialCheckComplete, updateProfile, updatePassword, signOut } = useAuth();\n  const navigate = useNavigate();\n\n  // Initialize form with user data\n  useEffect(() => {\n    if (profile) {\n      setFullName(profile.full_name || '');\n      setEmail(profile.email || '');\n    }\n  }, [profile]);\n\n  const handleProfileUpdate = async (e) => {\n    e.preventDefault();\n    \n    if (!fullName) {\n      setError('Please enter your full name');\n      return;\n    }\n\n    setIsLoading(true);\n    setError('');\n    setMessage('');\n\n    try {\n      const { error } = await updateProfile({ full_name: fullName });\n      if (error) throw error;\n      \n      setMessage('Profile updated successfully');\n      setIsEditing(false);\n    } catch (err) {\n      setError(err.message || 'Failed to update profile');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handlePasswordUpdate = async (e) => {\n    e.preventDefault();\n    \n    if (!currentPassword || !newPassword || !confirmPassword) {\n      setError('Please fill in all password fields');\n      return;\n    }\n\n    if (newPassword !== confirmPassword) {\n      setError('New passwords do not match');\n      return;\n    }\n\n    if (newPassword.length < 6) {\n      setError('Password must be at least 6 characters long');\n      return;\n    }\n\n    setIsLoading(true);\n    setError('');\n    setMessage('');\n\n    try {\n      // First, sign in with current password to verify\n      const { user: currentUser, error: signInError } = await signIn({ \n        email: user.email, \n        password: currentPassword \n      });\n      \n      if (signInError) throw new Error('Current password is incorrect');\n      \n      // If sign in is successful, update password\n      const { error: updateError } = await updatePassword(newPassword);\n      if (updateError) throw updateError;\n      \n      setMessage('Password updated successfully');\n      setCurrentPassword('');\n      setNewPassword('');\n      setConfirmPassword('');\n    } catch (err) {\n      setError(err.message || 'Failed to update password');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleSignOut = async () => {\n    try {\n      await signOut();\n      navigate('/');\n    } catch (error) {\n      console.error('Error signing out:', error);\n    }\n  };\n\n  // Show loading spinner while auth is being validated\n  if (loading || !initialCheckComplete) {\n    return (\n      <Container maxWidth=\"md\" sx={{ mt: 4, textAlign: 'center' }}>\n        <CircularProgress size={60} />\n        <Typography variant=\"body1\" sx={{ mt: 2 }}>\n          Loading profile...\n        </Typography>\n      </Container>\n    );\n  }\n\n  // Only show sign-in message if auth check is complete and no user\n  if (!user) {\n    return (\n      <Container maxWidth=\"md\" sx={{ mt: 4, textAlign: 'center' }}>\n        <Typography variant=\"h6\">Please sign in to view your profile</Typography>\n      </Container>\n    );\n  }\n\n  return (\n    <Container maxWidth=\"md\" sx={{ mt: 4, mb: 4 }}>\n      <Typography variant=\"h4\" component=\"h1\" gutterBottom>\n        My Profile\n      </Typography>\n\n      {error && (\n        <Alert severity=\"error\" sx={{ mb: 3 }}>\n          {error}\n        </Alert>\n      )}\n\n      {message && (\n        <Alert severity=\"success\" sx={{ mb: 3 }}>\n          {message}\n        </Alert>\n      )}\n\n      {/* Show loading state while profile data is being fetched */}\n      {!profile && user ? (\n        <Paper elevation={3} sx={{ p: 4, mb: 4, textAlign: 'center' }}>\n          <CircularProgress size={40} />\n          <Typography variant=\"body1\" sx={{ mt: 2 }}>\n            Loading profile data...\n          </Typography>\n        </Paper>\n      ) : (\n        <Paper elevation={3} sx={{ p: 4, mb: 4 }}>\n          <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\" mb={3}>\n            <Typography variant=\"h6\">Personal Information</Typography>\n            {!isEditing ? (\n              <IconButton\n                color=\"primary\"\n                onClick={() => setIsEditing(true)}\n                aria-label=\"edit profile\"\n              >\n                <EditIcon />\n              </IconButton>\n            ) : (\n              <Box>\n                <IconButton\n                  color=\"primary\"\n                  onClick={handleProfileUpdate}\n                  disabled={isLoading}\n                  aria-label=\"save changes\"\n                >\n                  <SaveIcon />\n                </IconButton>\n                <IconButton\n                  onClick={() => {\n                    setIsEditing(false);\n                    setError('');\n                    setMessage('');\n                    // Reset form\n                    setFullName(profile?.full_name || '');\n                  }}\n                  disabled={isLoading}\n                  aria-label=\"cancel editing\"\n                >\n                  <CancelIcon />\n                </IconButton>\n              </Box>\n            )}\n          </Box>\n\n          <Box display=\"flex\" alignItems=\"center\" mb={4}>\n            <Avatar\n              sx={{\n                width: 80,\n                height: 80,\n                fontSize: '2rem',\n                bgcolor: 'primary.main',\n                mr: 3\n              }}\n            >\n              {profile?.full_name ? profile.full_name.charAt(0).toUpperCase() : 'U'}\n            </Avatar>\n\n            <Box>\n              {isEditing ? (\n                <TextField\n                  label=\"Full Name\"\n                  value={fullName}\n                  onChange={(e) => setFullName(e.target.value)}\n                  variant=\"outlined\"\n                  size=\"small\"\n                  sx={{ mb: 1 }}\n                  fullWidth\n                />\n              ) : (\n                <Typography variant=\"h6\">\n                  {profile?.full_name || 'No name provided'}\n                </Typography>\n              )}\n              <Typography variant=\"body2\" color=\"text.secondary\">\n                {email}\n              </Typography>\n            </Box>\n          </Box>\n\n          <Divider sx={{ my: 3 }} />\n\n          <Typography variant=\"h6\" gutterBottom>\n            Change Password\n          </Typography>\n\n          <Box component=\"form\" onSubmit={handlePasswordUpdate} noValidate>\n            <TextField\n              margin=\"normal\"\n              required\n              fullWidth\n              name=\"currentPassword\"\n              label=\"Current Password\"\n              type=\"password\"\n              id=\"currentPassword\"\n              autoComplete=\"current-password\"\n              value={currentPassword}\n              onChange={(e) => setCurrentPassword(e.target.value)}\n              sx={{ mb: 2 }}\n            />\n\n            <TextField\n              margin=\"normal\"\n              required\n              fullWidth\n              name=\"newPassword\"\n              label=\"New Password\"\n              type=\"password\"\n              id=\"newPassword\"\n              autoComplete=\"new-password\"\n              value={newPassword}\n              onChange={(e) => setNewPassword(e.target.value)}\n              sx={{ mb: 2 }}\n            />\n\n            <TextField\n              margin=\"normal\"\n              required\n              fullWidth\n              name=\"confirmPassword\"\n              label=\"Confirm New Password\"\n              type=\"password\"\n              id=\"confirmPassword\"\n              value={confirmPassword}\n              onChange={(e) => setConfirmPassword(e.target.value)}\n              sx={{ mb: 3 }}\n            />\n\n            <Button\n              type=\"submit\"\n              variant=\"contained\"\n              disabled={isLoading}\n              startIcon={isLoading ? <CircularProgress size={20} /> : null}\n            >\n              Update Password\n            </Button>\n          </Box>\n        </Paper>\n      )}\n\n      <Box textAlign=\"center\" mt={4}>\n        <Button\n          variant=\"outlined\"\n          color=\"error\"\n          onClick={handleSignOut}\n          disabled={isLoading}\n        >\n          Sign Out\n        </Button>\n      </Box>\n    </Container>\n  );\n}\n"],"names":["CancelIcon","createSvgIcon","_jsx","SaveIcon","Profile","isEditing","setIsEditing","useState","fullName","setFullName","email","setEmail","currentPassword","setCurrentPassword","newPassword","setNewPassword","confirmPassword","setConfirmPassword","error","setError","message","setMessage","isLoading","setIsLoading","user","profile","loading","initialCheckComplete","updateProfile","updatePassword","signOut","useAuth","navigate","useNavigate","useEffect","handleProfileUpdate","e","err","handlePasswordUpdate","currentUser","signInError","updateError","handleSignOut","jsxs","Container","jsx","CircularProgress","Typography","Alert","Paper","Box","IconButton","EditIcon","Avatar","TextField","Divider","Button"],"mappings":"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","x_google_ignoreList":[0,1]}